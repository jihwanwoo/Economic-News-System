#!/usr/bin/env python3
"""
향상된 기사 작성 에이전트
다양한 관점의 상세한 분석 포함
"""

def create_enhanced_article_prompt(event, analysis_data):
    """향상된 기사 작성 프롬프트 (3배 확장)"""
    
    prompt = f"""
다음 정보를 바탕으로 매우 상세하고 전문적인 경제 기사를 작성해주세요:

**이벤트 정보:**
- 심볼: {event.symbol}
- 이벤트 유형: {event.event_type}
- 변화율: {event.change_percent:+.2f}%
- 심각도: {event.severity.value}
- 설명: {event.description}

**분석 데이터:**
- 현재 가격: {analysis_data.get('raw_data', {}).get('current_price', 'N/A')}
- 기술적 지표: {analysis_data.get('technical_indicators', {})}
- 통계 정보: {analysis_data.get('statistics', {})}
- 시장 비교: {analysis_data.get('market_comparison', {})}
- 전망: {analysis_data.get('forecast', {})}

**작성 요구사항:**
1. **3000-4000단어의 매우 상세한 기사** (기존 대비 3배 확장)
2. 전문적이고 객관적인 톤으로 작성
3. 데이터와 분석 결과를 근거로 제시
4. **다양한 전문가 관점 포함**

**기사 구조 (각 섹션별 상세 작성):**

## 1. 시장 상황 종합 분석 (600-800단어)
### 1.1 현재 시장 환경
- 글로벌 경제 상황과 배경
- 주요 경제 지표 동향
- 중앙은행 정책 영향
- 지정학적 리스크 요인

### 1.2 해당 종목/지수 현황
- 최근 가격 동향 및 변화 요인
- 거래량 분석 및 투자자 심리
- 업계 전반의 동향과 영향
- 경쟁사 대비 상대적 위치

## 2. 전문가 관점별 심층 분석 (800-1000단어)
### 2.1 **기자 관점** - 시장 동향 보도
- 뉴스 가치 및 시장 임팩트 분석
- 투자자들의 반응 및 시장 분위기
- 관련 뉴스 및 이슈 연관성
- 미디어 보도 트렌드 분석

### 2.2 **금융/경제학 교수 관점** - 학술적 분석
- 경제 이론적 배경 및 해석
- 과거 유사 사례와의 비교 분석
- 경제 모델을 통한 예측
- 장기적 경제 사이클 관점

### 2.3 **금융 담당 공무원 관점** - 정책적 시각
- 정부 정책과의 연관성
- 규제 환경 변화 영향
- 금융 안정성 관점
- 정책 대응 방향성

### 2.4 **기관투자자 관점** - 투자 전략
- 포트폴리오 관리 관점
- 리스크 관리 전략
- 자산 배분 영향
- 장기 투자 가치 평가

### 2.5 **개인투자자 관점** - 실용적 접근
- 개인 투자 전략 시사점
- 리스크 허용도별 대응 방안
- 투자 타이밍 고려사항
- 실용적 투자 팁

## 3. 기술적 분석 심화 (500-600단어)
### 3.1 주요 기술적 지표 상세 분석
- RSI, MACD, 스토캐스틱 등 모멘텀 지표
- 이동평균선 및 추세 분석
- 볼린저 밴드 및 변동성 지표
- 거래량 지표 및 시장 강도

### 3.2 차트 패턴 및 지지/저항선
- 주요 차트 패턴 식별
- 핵심 지지선과 저항선 분석
- 돌파 가능성 및 목표가 설정
- 기술적 리스크 요인

## 4. 펀더멘털 분석 및 배경 (500-600단어)
### 4.1 거시경제적 요인
- GDP, 인플레이션, 고용 지표 영향
- 통화정책 및 재정정책 영향
- 국제 무역 및 환율 요인
- 원자재 가격 동향

### 4.2 미시경제적 요인
- 기업 실적 및 재무 상황 (해당 시)
- 업계 동향 및 경쟁 환경
- 기술 혁신 및 사업 모델 변화
- 규제 변화 및 정책 영향

## 5. 시장 비교 및 상관관계 분석 (400-500단어)
### 5.1 벤치마크 대비 성과
- S&P 500, 나스닥 등 주요 지수 대비
- 동종 업계 ETF 대비 성과
- 글로벌 시장과의 상관관계
- 섹터 로테이션 관점

### 5.2 리스크 지표 분석
- 베타 계수 및 변동성 분석
- 샤프 비율 등 위험 조정 수익률
- VIX 등 공포 지수와의 관계
- 유동성 리스크 평가

## 6. 향후 전망 및 시나리오 분석 (600-800단어)
### 6.1 단기 전망 (1-3개월)
- 기술적 관점에서의 단기 방향성
- 주요 이벤트 및 발표 일정
- 계절적 요인 고려
- 단기 리스크 요인

### 6.2 중기 전망 (3-12개월)
- 펀더멘털 기반 중기 전망
- 업계 사이클 및 트렌드
- 정책 변화 영향
- 중기 투자 기회

### 6.3 장기 전망 (1-3년)
- 구조적 변화 및 메가트렌드
- 기술 혁신 영향
- 인구 구조 변화 등 장기 요인
- 지속가능성 관점

## 7. 투자 전략 및 리스크 관리 (400-500단어)
### 7.1 투자자 유형별 전략
- 보수적 투자자 대상 전략
- 적극적 투자자 대상 전략
- 기관투자자 관점
- 퇴직연금 등 장기 투자 관점

### 7.2 리스크 관리 방안
- 포지션 사이징 전략
- 손절매 및 익절 전략
- 헤징 전략 고려사항
- 분산투자 필요성

## 8. 결론 및 핵심 포인트 (300-400단어)
- 핵심 투자 포인트 요약
- 주의 깊게 관찰해야 할 지표
- 투자 결정 시 고려사항
- 전문가 의견 종합

**작성 지침:**
- 각 섹션은 구체적인 수치와 데이터를 인용하여 신뢰성 확보
- 전문 용어 사용 시 간단한 설명 병행
- 객관적 사실과 분석적 의견을 명확히 구분
- 투자 권유가 아닌 정보 제공 목적임을 명시
- 경제 전문지 수준의 깊이 있는 분석 제공
"""
    
    return prompt

# article_writer_agent.py 업데이트용 메서드
def update_article_writer_prompt():
    """기사 작성 에이전트의 프롬프트 업데이트"""
    
    enhanced_method = '''
    def _create_article_prompt(self, event, analysis_data: Dict[str, Any], plan: Dict[str, Any]) -> str:
        """기사 작성용 프롬프트 생성 (3배 확장 버전)"""
        
        from agents.enhanced_article_writer import create_enhanced_article_prompt
        return create_enhanced_article_prompt(event, analysis_data)
    '''
    
    return enhanced_method
